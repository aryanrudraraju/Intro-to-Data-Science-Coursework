---
title: |
  | Introduction to Data Science
  | R Tutorial
  | Week 5  
author: |
  | Ilse Cuevas Andrade and Dr. Gah-Yi Ban
  | Imperial College Business School
  
output:
  pdf_document: default
  html_document:
    df_print: paged
---

Data Visualisation (continued)
====================


This tutorial covers data visualisation skills and pipe operators.

Let's use `tidyverse` package to support `%>%` operators and `ggplot2` to support
data visualization.

**NOTE:** if you don't have tidyverse and ggplot2 packages on your RStudio. Please install
it by running `install.packages("tidyverse")` then `install.packages("ggplot2")` in the R Console.

```{r load lib, warning=F, message=F}
library(tidyverse)
library(ggplot2)
```

Before starting any practice and exercises, load the dataset "uk_gdp_and_weeklyWage.csv".


```{r load data}
uk_gdp_and_weeklyWage <- read.csv("uk_gdp_and_weeklyWage.csv", 
                                  stringsAsFactors = F)

```


Next, add GDP growth rates and categorize the growth rate into quartiles.
*Hint:* there will be NA(s) in the GDP growth rates data

```{r mutate}


uk_gdp_and_weeklyWage <- uk_gdp_and_weeklyWage %>% 
  mutate(GDP_growth_rate = (GDP_m - lag(GDP_m)) / lag(GDP_m) * 100, 
         weeklyWageQuantile = cut(Weekly_pay, 
                                  quantile(Weekly_pay, 
                                           probs = seq(0, 1, 0.25), type = 7), 
                                  include.lowest = T, labels = F)
         )



uk_gdp_and_weeklyWage <- uk_gdp_and_weeklyWage %>% 
  mutate (GDP_per_cap = GDP_m/Population*1000000) # calculate GDP per Capita (£)

uk_gdp_and_weeklyWage <- uk_gdp_and_weeklyWage %>% 
  mutate (wage_level = Weekly_pay > 500) 


```

Create a histogram of weekly pay with density estimation using ggplot2 in R, with the following specifications: the histogram should have 6 bins, black borders, a light blue fill, and a dashed line for the density curve.

To add a density line to the histogram, you need to add `geom_density()` after
`geom_histogram`. Try in the following exercise.

*Exercise 1*

```{r Exercise 1}


```


Using the dataset uk_gdp_and_weeklyWage, create a plot that visualises the distribution of weekly pay. The plot should include a histogram with 6 bins, black borders, and a light blue fill, along with a density curve overlay that has a light pink fill and an alpha transparency of 0.3. The density curve should be displayed with a dashed line style. Use ggplot2 to generate the visualisation.


`alpha` and `fill` can be set in the `geom_density`. `alpha` is for transparency of 
density and `fill` is for filling colour of density (PDF, probability density function). 
In exercise 2, add `alpha` with 0.2 and `fill` with "lightpink" in the `geom_density`.

*Exercise 2*
```{r Exercise 2}



```

In the next exercise, add a solid blue mean line to the histogram plot based on 
Exercise 2.

*Exercise 3*
```{r Exercise 3}



```

You can make further modifications to the plot, e.g., (i) adjusting the appearance of the density plot (`geom_density`) by changing the alpha level and fill color for better visibility; (ii) adjusting the appearance of the vertical line (`geom_vline`) by changing its color, linetype, and size; (iii) adding labels for the title, x-axis, and y-axis to improve clarity and (iv) using a minimal theme for a clean appearance and making various theme adjustments for text size, grid lines, and legend.

Run and study the code chunk below, then try your own variations.

```{r}


# Create the plot
uk_gdp_and_weeklyWage %>% 
  ggplot(aes(x = Weekly_pay, y = after_stat(density))) +
  geom_histogram(bins = 6, color = "black", fill = "lightblue", linetype = "dashed") +
  geom_density(alpha = 0.5, fill = "lightpink") + # Adjust density appearance
  geom_vline(aes(xintercept = mean(Weekly_pay)),
             color = "blue", linetype = "solid", size = 1) + # Adjust vline appearance
  labs(
    title = "Distribution of Weekly Wage",
    x = "Weekly Wage (£)",
    y = "Density"
  ) +
  theme_minimal() + # Use a minimal theme
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"), # Adjust title appearance
    axis.text = element_text(size = 10), # Adjust axis text size
    axis.title = element_text(size = 12), # Adjust axis title size
    panel.grid.major = element_line(colour = "gray90"), # Adjust grid line color
    panel.grid.minor = element_blank(), # Remove minor grid lines
    legend.position = "none" # Remove legend
  )

```


## The End
